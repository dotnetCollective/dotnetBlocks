<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link href="/assets/bootstrap/bootstrap.css" rel="stylesheet" />
                <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Roboto+Slab:wght@400;700&family=Roboto:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap" rel="stylesheet" data-no-mirror>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.26.0/themes/prism.css">
        <link href="/assets/css/theme.css" rel="stylesheet" />
        <link href="/assets/css/styles.css" rel="stylesheet" />

        <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
        <script src="https://kit.fontawesome.com/a1cad7ed9a.js" crossorigin="anonymous" data-no-mirror></script>
        <script src="https://cdn.jsdelivr.net/npm/mermaid@8.4.8/dist/mermaid.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.26.0/components/prism-core.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.26.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
        <script src="https://cdn.jsdelivr.net/npm/quicklink@2.0.0/dist/quicklink.umd.js"></script>
	    
        <!-- Lunr search -->

        

        

        <title>.NetBlocks - Business Entities</title>
    </head>
    <body class="d-flex flex-column">
        <div class="flex-grow-1 d-flex flex-column">
            <div class="bg-nav">
                <div class="container-xl py-3">
                    <div class="row">
                        <div class="offset-lg-2 col-12 col-lg-8 px-0">
                            <nav class="navbar navbar-expand-md navbar-light align-items-start">
    <a class="navbar-brand" href="/">
                <span class="text-primary">.NetBlocks</span>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapse-topnav" aria-controls="collapse-topnav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div id="collapse-topnav" class="collapse navbar-collapse flex-wrap">
        <ul class="navbar-nav mr-auto">
            
        </ul>
        <ul class="navbar-nav">
                    <li class="nav-item">
            <a class="nav-link" href="/get.started">Get started</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Libraries">Libraries</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Design">Design</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/api">API</a>
        </li>

            
        </ul>
    </div>
</nav>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="flex-grow-1 d-flex flex-column">
                    <!-- Titlebar -->
                    <div id="titlebar" class="py-4">
                        <div class="container-xl">
                            <div class="row">
                                <div class="offset-lg-2 col-12 col-lg-8 px-3 px-lg-0 w-100 d-flex flex-wrap align-items-end">
                                    <div class="flex-grow-1">
                                        <div class="breadcrumbs d-flex flex-column flex-md-row text-break">

        <span><a href="/Design">Design</a></span>
                                        </div>
                                        <div class="text-white m-0 text-break title">

Business Entities
                                        </div>
                                    </div>
                                        <div class="navbar navbar-expand-md navbar-dark p-0">
                                            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#left-sidebar" aria-controls="left-sidebar" aria-expanded="false" aria-label="Toggle navigation">
                                                <span class="navbar-toggler-icon"></span>
                                            </button>
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Under title -->
                    <div id="undertitle">
                        <div class="container-xl">
                            <div class="row">
                                    <div class="col-md-3 col-lg-2">
                                    </div>
                                    <div class="col-md-9 col-lg-8 bg-white">
                                    </div>
                                <div class="col-lg-2 d-none d-lg-block">
                                </div>
                            </div>
                        </div>
                    </div>

                <!-- Body -->
                <div class="flex-grow-1 d-flex flex-column">
                        <div class="container-xl flex-grow-1 d-flex flex-column">
                            <div class="row flex-grow-1 align-items-stretch">
                                        <div class="col-md-3 col-lg-2 p-md-0 m-md-0 bg-body">
                                            <div id="left-sidebar" class="sidebar collapse px-0 px-md-3 pt-3">

<div class="sidebar-root">

<div class="sidebar-nav-item">
    <a href="/Design">The Design</a>
</div>
<div class="sidebar-nav-item active">
    <a href="/Design/business.entities">Business Entities</a>
</div>
<div class="sidebar-nav-item">
    <a href="/Design/business.logic">Business Logic</a>
</div>
<div class="sidebar-nav-item">
    <a href="/Design/operations">Operations</a>
</div>
<div class="sidebar-nav-item">
    <a href="/Design/references">References</a>
</div>
<div class="sidebar-nav-item">
    <a href="/Design/servicebus">Service Bus</a>
</div></div>                                            </div>
                                        </div>
                                        <div id="content" class="col-md-9 col-lg-8 p-4 pt-md-0 bg-white">
<h1 id="design-overview">Design Overview</h1>
<p>Entities are business object models that can be serialized, transmitted or used in a persistance strategy (typically EF or blob storage);
Business entities are similar to data transfer objects in older n-tier paradigms.</p>
<h1 id="business-entities">Business entities</h1>
<p>Business entities are the basis for all business models. They can also be used in method parameters and serialized for transmission. Descending from business entities helps with discovery and for the cration of generic type closures to create a better experience for developers using the architecture.</p>
<h1 id="keyed-entities">Keyed Entities</h1>
<p>Keyed entities define an identifier for a business entity to uniquely identify that instance. A unique ID is mostly required for CRUD purposes.</p>
<h1 id="global-keyed-entities">Global Keyed Entities</h1>
<p>Global entities using a GUID as their unique identifier, but a default implementation of a CombGuid (Combinational Guid) is provided to reduce the impact of random distributions. That topic is discussed at length elsewhere.
#Auditable Entities
Auditable entities use a composition model to persist information about the standard CRUD operations of entities.
#Persistence.
Business entities are not active, but their common structures mean tasks like persistence can be made generic reducing the amount of coding required.</p>
<h1 id="abstract-base-and-generic-derived-class-problem">Abstract base and Generic derived class problem</h1>
<p>This article explains the design pattern for derived classes.
<a href="https://www.devgem.io/posts/resolving-generic-type-conversion-issues-in-c-inheritance">https://www.devgem.io/posts/resolving-generic-type-conversion-issues-in-c-inheritance</a></p>
<p>#Keying strategies</p>
<p>storing, retrieving and uniquely identifying objects requires an identification system. The identifiers are called keys, with a subset of keys being called ids.</p>
<p>The framework makes a keyed business entity available for use.</p>
<ol>
<li>Keyed entities - generic class allowing a key type during closure.</li>
</ol>
<h2 id="key-or-id-types">Key or ID types</h2>
<p>For performance reasons, data bases and other repository types prefer sequential increased identifiers. numeric id types are preferred.</p>
<p>Disadvantage of numeric types is the ID cannot be allocated in advance, so it can only be generated during persistence. Numeric keys are not portable and are typically re-assigned when data is moved between repositories.</p>
<p>Global Identifiers (GUIDS) allow any system to generate an ID. Guids are a random number and the uniform distribution causes performance issues in most repository technologies.</p>
<p>GUIDS have the advantage of being portable, so data can be moved from system to system or correlated across multiple systems.</p>
<h2 id="generating-guids">Generating GUIDs</h2>
<p>Alternate GUID generation algorithmns create semi-unique ever increasing numbers. This helps but doesn't mitigate the poor performance of GUIDS.
The algorithm recommended for the framework is the CombGuid algorithmn first created by Jimmmy Nilsson. The referenced nuget library for GUID generation gives framework users lots of options.</p>
<h2 id="dual-keying">Dual keying</h2>
<p>The framework provides a dual keyed object using an ID field and an additional GlobalID to store a guid. This is a best of both worlds blend allowing portability between rpositories but performance within a single repository.</p>
<p>The entities are the BusinessEntity (ID) and the GlobalKeyedEntity (ID and Global ID);</p>
<h2 id="business-entities-1">Business Entities</h2>
<ol>
<li>BusinessEntity - base class for business entities using for type closures</li>
<li>
<ol start="2">
<li>KeyedEntity - Business Entity with a generic ID property</li>
<li>GlobalKeyedEntity - Dual keyed entity with Generic ID property and a GUID Global ID (Recommended.)</li>
<li>IAuditable Entities - versions of the entity types implementing the IAuditable interface and properties, so store data about the CRUD operations for auditing purposes.</li>
</ol>
</li>
</ol>


                                        </div>
                                <div class="col-lg-2 p-md-0 m-md-0 bg-body">
                                    <div id="right-sidebar" class="sidebar px-0 px-md-3 pt-3">
        <div class=" mb-3 sidebar-root">
            <div class="sidebar-nav-item sidebar-header">On This Page</div>
            <div class="sidebar-nav-children">
                    <div class="sidebar-nav-item"><a href="#design-overview">Design Overview</a></div>
                    <div class="sidebar-nav-item"><a href="#business-entities">Business entities</a></div>
                    <div class="sidebar-nav-item"><a href="#keyed-entities">Keyed Entities</a></div>
                    <div class="sidebar-nav-item"><a href="#global-keyed-entities">Global Keyed Entities</a></div>
                    <div class="sidebar-nav-item"><a href="#abstract-base-and-generic-derived-class-problem">Abstract base and Generic derived class problem</a></div>
                        <div class="sidebar-nav-children">
                                <div class="sidebar-nav-item"><a href="#key-or-id-types">Key or ID types</a></div>
                                <div class="sidebar-nav-item"><a href="#generating-guids">Generating GUIDs</a></div>
                                <div class="sidebar-nav-item"><a href="#dual-keying">Dual keying</a></div>
                                <div class="sidebar-nav-item"><a href="#business-entities-1">Business Entities</a></div>
                        </div>
            </div>
        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div id="footer" class="p-3 text-white">
            <div class="container-xl">
                <div class="row">
    <div class="offset-lg-2 col-12 col-lg-8">
        <div class="pt-2 font-size-sm text-muted text-center">
            Generated By <a class="text-muted" href="https://statiq.dev">Statiq</a>
        </div>
    </div>
</div>
            </div>
        </div>

        <!-- Scripts -->
        <script>
            $(document).ready(function() {
                quicklink.listen();

                // Bootstrap tooltips
                $('[data-toggle="tooltip"]').tooltip();

				// Keeps the sidebars in view on wider viewports
				let left = null;
				let leftParent = null;
				let right = null;
				let rightParent = null;
                function stickSidebars()
				{
				    if (left == null) {
                        left = $('#left-sidebar');
                        right = $('#right-sidebar');
                    }
                    if (left.length) {
                        if (window.innerWidth >= 768) {
                            if (leftParent == null) {
                                leftParent = left.parent()[0];
                            }
                            if (leftParent) {
                                let leftRect = leftParent.getBoundingClientRect();
                                stickSidebar(left,  leftRect);
                            }
                        } else {
                            left.css('position', 'relative');
                            if (left.css('bottom') != 0) {
                                left.css('bottom', '0');
                            }
                        }
                    }
                    if (right.length) {
                        if (window.innerWidth >= 768) {
                            if (rightParent == null) {
                                rightParent = right.parent()[0];
                            }
                            if (rightParent) {
                                let rightRect = rightParent.getBoundingClientRect();
                                stickSidebar(right,  rightRect);
                            }
                        } else {
                            right.css('position', 'relative');
                            if (right.css('bottom') != 0) {
                                right.css('bottom', '0');
                            }
                        }
                    }
				}
				function stickSidebar(sidebar, rect) {
                    // Bottom
                    if (rect.bottom > window.innerHeight) {
                        sidebar.css('bottom', rect.bottom - window.innerHeight + "px");
                    } else {
                        sidebar.css('bottom', 0);
                    }
                    // Top
                    if (rect.top < 0) {
                        sidebar.css('position', 'sticky');
                    } else {
                        sidebar.css('position', 'absolute');
                    }
				}
				$(window).on("load", function() {
				    stickSidebars();
				});
                $(window).scroll(function() {
				    stickSidebars();
				});
				$(window).resize(function() {
				    stickSidebars();
				})

                // Mermaid diagrams
                mermaid.initialize(
                {
                    flowchart:
                    {
                        useMaxWidth: false
                    },
					startOnLoad: false,
					cloneCssStyles: false
                });
                mermaid.init(undefined, ".mermaid");

                // Remove the max-width setting that Mermaid sets
                var mermaidSvg = $('.mermaid svg');
                mermaidSvg.addClass('img-fluid');
                mermaidSvg.css('max-width', '');

                // Make it scrollable
				var target = document.querySelector(".mermaid svg");
				if(target !== null)
				{
					var panZoom = window.panZoom = svgPanZoom(target, {
						zoomEnabled: true,
						controlIconsEnabled: true,
						fit: true,
						center: true,
                        maxZoom: 20,
                        zoomScaleSensitivity: 0.6
					});

                    // Do the reset once right away to fit the diagram
                    panZoom.resize();
                    panZoom.fit();
                    panZoom.center();

                    $(window).resize(function(){
                        panZoom.resize();
                        panZoom.fit();
                        panZoom.center();
                    });
				}
            });
        </script>

        

        
    </body>
</html>